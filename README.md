# java-lotto-precourse

# 프리코스 3 주차 - 로또

## 기능 목록

- [x] 로또
    - [x] 구입 금액만큼 6개의 중복 없는 랜덤 숫자 뽑기 (1~45)
    - [x] 일치하는 번호 개수 확인
    - [x] 등수별 당첨 개수 계산
    - [x] 수익률 계산
- [x] 입력
    - [x] 구입 금액 입력
    - [x] 당첨 로또 번호 6개 입력
    - [x] 보너스 번호 1개 입력
- [x] 출력
    - [x] 구입한 로또 전체 출력
    - [x] 당첨 통계 출력
- [x] 예외 처리
    - [x] 금액 입력 예외 처리
    - [x] 당첨 번호 예외 처리
    - [x] 보너스 번호 예외 처리
    - [x] 로또 중복 번호 예외 처리

## 프로그램 순서도

![](https://github.com/user-attachments/assets/c1190a84-b62b-46ec-9f7d-d7d899cf5bae)

## 구현 과정
### 로또
**구입 금액만큼 중복 없는 랜덤 숫자 뽑기**

사용자 입력에 따라 구입 금액이 바뀌기 때문에 `User` 클래스에 메서드를 작성했습니다.
count만큼 반복하여 무작위 값 6개의 Lotto 인스턴스를 생성해 `lottos`에 추가했습니다.

**일치하는 번호 개수 확인**

각 로또를 입력한 당첨 번호, 보너스 번호와 비교하여 해당하는 등수를 반환해야 하므로 `Lotto` 클래스에 메서드를 작성했습니다.
```java
long matchCount = this.numbers.stream()
                .filter(n -> winningNumber.numbers.stream().anyMatch(Predicate.isEqual(n)))
                .count();
boolean bonusMatch = this.numbers.stream().anyMatch(Predicate.isEqual(bonusNumber));
```
stream을 이용해 당첨 번호, 보너스 번호와 각각 비교해 일치하는 개수와 여부를 반환받고 `findRank` 메서드를 호출해 해당하는 등수를 반환합니다.

**등수별 당첨 개수 계산**

사용자가 구입한 로또와 비교하는 메서드이기 때문에 `User` 클래스에 메서드를 작성했습니다.

각 로또를 `countMatchNumber` 메서드로 확인해 당첨된 등수를 확인하고 이를 모두 List로 반환했습니다.
이후 당첨 등수를 key, 당첨 횟수를 value로 갖는 HashMap을 생성해 만약 key가 존재한다면 당첨 횟수를 하나씩 추가하는 방식으로 구현하여 Map을 반환하도록 구현했습니다.

**수익률 계산**

앞서 만든 `HashMap`을 반복문으로 돌며 총당첨금을 계산합니다.
- 수익률 = (총당첨금) / (구입 금액) * 100

### 입력
**구입 금액 입력**

1,000원 단위의 구입 금액을 입력받습니다.
- 숫자가 아닌 경우
- 1,000원 단위가 아니거나 1,000원보다 작은 경우

이 중 하나라도 해당하면 예외를 발생시키고 다시 입력받도록 구현했습니다.

**당첨 로또 번호 6개 입력**

당첨 로또 번호 6개를 입력받아 `,`로 구분해 `Lotto`로 반환합니다. 이때 입력에서 공백은 제거합니다.
- 숫자가 아닌 경우
- 1과 45 사이의 숫자가 아닌 경우
- 중복 값이 있는 경우
- 입력받은 숫자가 6개가 아닌 경우

이 중 하나라도 해당하면 예외를 발생시키고 다시 입력받도록 구현했습니다.

**보너스 번호 1개 입력**

보너스 번호 1개를 입력받아 반환합니다.
- 숫자가 아닌 경우
- 1과 45 사이의 숫자가 아닌 경우
- 입력한 당첨 번호와 중복인 경우
이 중 하나라도 해당하면 예외를 발생시키고 다시 입력받도록 구현했습니다.

### 출력
**구입한 로또 전체 출력**

구입한 로또 개수를 출력하고 각 로또의 번호를 출력합니다.
- 문자열을 하드 코딩하지 않기 위해 상수로 작성하고 `System.out.printf()`를 이용해 출력했습니다.
- 로또의 출력을 위해 `Lotto`클래스에 `toString` 메서드를 오버라이딩했습니다.

**당첨 통계 출력**

`Rank`에 `getRankInfo` 메서드를 작성해 해당하는 등수에 따라 출력 내용을 받아와 출력을 간결하게 할 수 있도록 구현했습니다.
```java
public static String getRankInfo(Rank rank) {
    if (rank == Rank.SECOND) {
        return rank.matchCount + "개 일치, 보너스 볼 일치 (" + String.format("%,d", rank.prize) + "원)";
    }
    return rank.matchCount + "개 일치 (" + String.format("%,d", rank.prize) + "원)";
}
```
2등인 경우에만 출력을 다르게 하기 위해 위와 같이 구현했습니다.

`getOrDefault()`를 사용해 만약 당첨 기록이 없는 등수라면 0을 출력하고 당첨 기록이 있다면 당첨 횟수를 출력하도록 구현했습니다.

수익률을 소수점 둘째 자리에서 반올림하기 위해 `%.1f`와 같이 작성하고 `printf()`로 출력했습니다.